<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Sora:wght@400;500;600&display=swap" rel=stylesheet><link rel=canonical href=https://qbart.dev/posts/2019/experimenting-with-github-actions-beta/><title>Experimenting With Github Actions (beta) | Bartłomiej Wójtowicz</title><meta property="og:type" content="website"><meta property="og:title" content="Experimenting With Github Actions (beta)"><meta property="og:description" content="Engineering blog of Bartłomiej Wójtowicz. CTO at Selleo Labs. Co-founder of Soft Kiwi Games. Articles and notes about software, including personal thoughts, small experiments, and things I find interesting along the way."><meta property="og:url" content="https://qbart.dev/posts/2019/experimenting-with-github-actions-beta/"><meta property="og:site_name" content="Bartłomiej Wójtowicz"><link rel=stylesheet href=/css/main.min.cd94ea63cd255ec6242569f913ec7689d2709f4b0d5b2c85507164eb1b5f671e.css integrity="sha256-zZTqY80lXsYkJWn5E+x2idJwn0sNWyyFUHFk6xtfZx4=" crossorigin=anonymous><script src=/js/main.3a782c255da1f2c5ba60d3899b7490960df6fbfc0b0a92cf0418b1442316a44b.js integrity="sha256-OngsJV2h8sW6YNOJm3SQlg32+/wLCpLPBBixRCMWpEs=" crossorigin=anonymous></script></head><body id=top><header><div class=container><nav><a href=/ class=logo><svg width="48" height="48" stroke-width="1.5" viewBox="0 0 24 24" fill="none" color="#000"><path d="M13 16h5" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M6 8l4 4-4 4" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 18V6c0-1.10457.89543-2 2-2H20c1.1046.0 2 .89543 2 2V18C22 19.1046 21.1046 20 20 20H4C2.89543 20 2 19.1046 2 18z" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a><div class=nav-actions><a href=https://www.linkedin.com/in/bart%C5%82omiej-w%C3%B3jtowicz/ class="btn btn-connect"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" aria-hidden="true"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
Connect</a></div></nav></div></header><main class=container><section class=article><a class=back-link href=/posts/><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
Back</a><article class=article-body><div class=article-header><div class=article-kicker>Writing</div><h1 class=article-title>Experimenting With Github Actions (beta)</h1><div class=article-meta><span>05 Jan, 2019</span>
<span>8 min read</span></div></div><div class=article-grid><div class=article-content><p>This article was originally published <a href=https://medium.com/selleo/experimenting-with-github-actions-beta-760e61fab0e1>here</a>.</p><p>With the upcoming new GitHub Actions feature, I was very excited to test it, so I immediately signed up for the beta access and finally my invitation had been accepted.</p><p>The reason for my excitement mainly comes from my current project where I am mostly responsible for managing the infrastructure in AWS (Terraform) and backend development (Ruby on Rails) — if I have time for it. We also have a lot of PWA that we deploy to AWS Cloudfront so there is a constant need for automation (we still do some things manually but we are improving everyday). Our simplified pipeline looks like this:</p><ol><li>GitHub PR (master &lt;- feature branch)</li><li>CircleCI</li></ol><ul><li>linter</li><li>specs</li><li>aws push to CodePipeline or trigger Cloudfront invalidation for PWA (only from master)</li></ul><ol start=3><li>AWS CodePipeline starts image building and ECS deployment</li></ol><p>As much as I like some of the Amazon services, AWS CodePipeline is not one of them so with GitHub Actions on the rise I hope to replace it completely. To verify if that&rsquo;s even possible I created a dummy project that will test the following:</p><ul><li>linter (rubocop)</li><li>tests (rspec)</li><li>deployment from master only (Heroku will do for now, I can expand that later to AWS)</li><li>notification (when the process is done)</li></ul><p>In this article, I won&rsquo;t be going into details what GitHub Actions is and how everything works because GitHub documentation will do a much better job and I don&rsquo;t want to duplicate the content that is already there, especially, that it is a beta and things might change. I will only highlight a few things and most of the time I will leave you with the link to the GitHub pages.</p><p>For the Ruby app I used Sinatra and wrote one silly endpoint:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>get <span style=color:#666;font-style:italic>&#39;/&#39;</span> <span style=font-weight:700;text-decoration:underline>do</span>
</span></span><span style=display:flex><span>   <span style=color:#666;font-style:italic>&#34;</span><span style=color:#666;font-style:italic>#{</span><span style=color:#666;font-weight:700;font-style:italic>ENV</span>[<span style=color:#666;font-style:italic>&#39;RACK_ENV&#39;</span>]<span style=color:#666;font-style:italic>}</span><span style=color:#666;font-style:italic>: Hello there! My secret is </span><span style=color:#666;font-style:italic>#{</span><span style=color:#666;font-weight:700;font-style:italic>ENV</span>[<span style=color:#666;font-style:italic>&#39;MY_SECRET&#39;</span>]<span style=color:#666;font-style:italic>}</span><span style=color:#666;font-style:italic>&#34;</span>
</span></span><span style=display:flex><span><span style=font-weight:700;text-decoration:underline>end</span>
</span></span></code></pre></div><p>and its corresponding spec:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>describe <span style=color:#666;font-style:italic>&#39;Test GitHub Action&#39;</span> <span style=font-weight:700;text-decoration:underline>do</span>
</span></span><span style=display:flex><span>  it <span style=color:#666;font-style:italic>&#39;returns appropriate text for index page&#39;</span> <span style=font-weight:700;text-decoration:underline>do</span>
</span></span><span style=display:flex><span>    get <span style=color:#666;font-style:italic>&#39;/&#39;</span>
</span></span><span style=display:flex><span>    expect(last_response.body).to eq <span style=color:#666;font-style:italic>&#39;test: Hello there! My secret is 123&#39;</span>
</span></span><span style=display:flex><span>  <span style=font-weight:700;text-decoration:underline>end</span>
</span></span><span style=display:flex><span><span style=font-weight:700;text-decoration:underline>end</span>
</span></span></code></pre></div><p>For Docker, no surprises here, just a small file:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=font-weight:700;text-decoration:underline>FROM</span> <span style=color:#666;font-style:italic>ruby:2.5.1</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ARG</span> RACK_ENV<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ARG</span> PORT<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ENV</span> APP_HOME /app<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> apt-get update -qq &amp;&amp; apt-get install -y build-essential<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> mkdir <span style=color:#666;font-weight:700;font-style:italic>$APP_HOME</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>WORKDIR</span> <span style=color:#666;font-style:italic>$APP_HOME</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ADD</span> . <span style=color:#666;font-weight:700;font-style:italic>$APP_HOME</span>/<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> bundle install — without development test<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>CMD</span> rackup -p <span style=color:#666;font-weight:700;font-style:italic>$PORT</span> — host 0.0.0.0<span>
</span></span></span></code></pre></div><p>GitHub Actions come with some predefined actions built by the GitHub team. One of them is Heroku and Docker cli tools, to name a few. For more, please take a look at the documentation <a href=https://github.com/actions>here</a>.</p><p>There is also a GUI for defining actions and works pretty well but I prefer doing this in my code editor.</p><p>First, create a workflow file <code>.github/main.workflow</code>:</p><pre tabindex=0><code class=language-github data-lang=github>workflow &#34;Test and deploy to Heroku&#34; {
 on = &#34;push&#34;
 resolves = [&#34;ruby.build&#34;]
}
</code></pre><p><a href=https://developer.github.com/actions/managing-workflows/workflow-configuration-options/>Workflow</a> definition is pretty self-explanatory so just a short comment:</p><ul><li><code>on</code> defines event when the whole process kicks in (push type is the only one available in beta)</li><li><code>resolves</code> specifies a list of target actions to resolve (you can put any text here but I kinda like namespace.action convention for my purposes - this comes in handy later when you declare your action dependencies)</li></ul><p>First action:</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;ruby.build&#34; {
 uses = &#34;actions/docker/cli@master&#34;
 args = &#34;build -f Dockerfile.test -t ci-$GITHUB_SHA:latest .&#34;
}
</code></pre><p>This will build a docker container that will be used for linting and testing.</p><p>Please also note that there some built-in <code>GITHUB_*</code> envs for you to use, list <a href=https://developer.github.com/actions/creating-github-actions/accessing-the-runtime-environment/#environment-variables>here</a>.</p><p>Action breakdown:</p><ul><li><code>uses</code> declares what kind of action will it be and could be read as follows: <code>:github_user_or_org_name/:repository/:folder@:ref</code> — as a ref I used master but for production workflows, you probably want to stick with a specific release tag or commit SHA and upgrade periodically</li><li><code>args</code> are just arguments passed to underlying command (in this action it will be <code>docker ...</code>)</li></ul><p>Take a look here how the action repository looks like <a href=https://github.com/actions/docker/tree/master/cli>here</a>.</p><p>Next part of the workflow can be run in parallel so:</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;ruby.rubocop&#34; {
 uses = &#34;actions/docker/cli@master&#34;
 needs = [&#34;ruby.build&#34;]
 args = &#34;run ci-$GITHUB_SHA:latest rubocop&#34;
}

action &#34;ruby.rspec&#34; {
 uses = &#34;actions/docker/cli@master&#34;
 needs = [&#34;ruby.build&#34;]
 args = &#34;run ci-$GITHUB_SHA:latest rspec&#34;
}
</code></pre><p>Nothing new here except <code>needs</code> that specifies dependencies for actions (and that&rsquo;s why I am using <code>namespace.action</code> style rather than using <code>Build Ruby image</code> etc., it&rsquo;s just easier for me to track it with eyes).</p><p>I used a separate <code>Dockerfile</code> for a test environment so I can declare required variables there:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=font-weight:700;text-decoration:underline>FROM</span> <span style=color:#666;font-style:italic>ruby:2.5.1</span><span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ENV</span> RACK_ENV test<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ENV</span> MY_SECRET 123 <span style=color:#888;font-style:italic># if you want this to be out of the repo just use `ARG MY_SECRET` and define secrets in github action</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ENV</span> APP_HOME /app<span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> apt-get update -qq &amp;&amp; apt-get install -y build-essential<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> mkdir <span style=color:#666;font-weight:700;font-style:italic>$APP_HOME</span><span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>WORKDIR</span> <span style=color:#666;font-style:italic>$APP_HOME</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ADD</span> . <span style=color:#666;font-weight:700;font-style:italic>$APP_HOME</span>/<span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> bundle install<span>
</span></span></span></code></pre></div><p>Ok, so tests are running, now we want to start a deployment but only if the branch is <code>master</code>. There is another pre-built <a href=https://github.com/actions/bin>action</a> for that:</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;git.master&#34; {
  uses = &#34;actions/bin/filter@master&#34;
  needs = [&#34;ruby.rubocop&#34;, &#34;ruby.rspec&#34;]
  args = &#34;branch master&#34;
}
</code></pre><p>Before we start with Heroku workflow we need to create a project first. We will also need:</p><ul><li>to generate Heroku api key (<code>heroku authorizations:create</code>)</li><li>to set the stack to the container based (<code>heroku stack:set container</code>)</li><li>a project name (I named mine <code>test-github-actions</code>)</li></ul><p>Heroku action is described <a href=https://github.com/actions/heroku>here</a>. As of now, there is only one required secret <code>HEROKU_API_KEY</code> that has to contain your authorization key. You want to add this key to GitHub <a href=https://developer.github.com/actions/managing-workflows/storing-secrets/>secrets</a>.</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;heroku.login&#34; {
  uses = &#34;actions/heroku@master&#34;
  needs = [&#34;git.master&#34;]
  args = &#34;container:login&#34;  secrets = [&#34;HEROKU_API_KEY&#34;]
}
</code></pre><p><code>secrets</code> tells to decrypt declared variables in this action and expose them internally as an ENV (otherwise they won&rsquo;t be available), also <strong>do not</strong> print them because they might remain in logs.</p><p>Once we are logged in we can push our image:</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;heroku.push&#34; {
  uses = &#34;actions/heroku@master&#34;
  needs = &#34;heroku.login&#34;
  args = &#34;container:push web&#34;

  secrets = [
    &#34;HEROKU_API_KEY&#34;,
    &#34;HEROKU_APP&#34;
  ]

  env = {
    RACK_ENV = &#34;production&#34;
  }
}
</code></pre><p>A little more explanation here, first I used <code>HEROKU_APP</code> which means that container will push image to whatever app that is defined there. There are actually multiple ways of how this could be achieved:</p><pre tabindex=0><code class=language-github data-lang=github>args = &#34;container:push -a test-github-actions web&#34;
</code></pre><p>or</p><pre tabindex=0><code class=language-github data-lang=github>args = &#34;container:push web&#34;

env = {
  HEROKU_APP = &#34;test-github-actions&#34;
}
</code></pre><p>Personally, I preferred to put in secrets here so it requires less typing later if you need to use it multiple times in different actions.</p><p><code>RACK_ENV = "production"</code> is defined here as a building environment variable for docker image (our dockerfile had: <code>ARG RACK_ENV</code>).</p><p>For the following piece, I used <code>heroku config:set</code> command to propagate all my variables and secrets to heroku runtime variables:</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;heroku.envs&#34; {
  uses = &#34;actions/heroku@master&#34;
  needs = &#34;heroku.push&#34;

  args = [
    &#34;config:set&#34;,
    &#34;RACK_ENV=$RACK_ENV&#34;,
    &#34;MY_SECRET=$MY_SECRET&#34;
  ]

  secrets = [
    &#34;HEROKU_API_KEY&#34;,
    &#34;HEROKU_APP&#34;,
    &#34;MY_SECRET&#34;
  ]

  env = {
    RACK_ENV = &#34;production&#34;
  }
}
</code></pre><p>And finally, a deployment:</p><pre tabindex=0><code class=language-github data-lang=github>action &#34;heroku.deploy&#34; {
  uses = &#34;actions/heroku@master&#34;
  needs = [&#34;heroku.envs&#34;, &#34;heroku.push&#34;]

  args = [&#34;container:release&#34;, &#34;web&#34;]

  secrets = [
    &#34;HEROKU_API_KEY&#34;,
    &#34;HEROKU_APP&#34;,
    &#34;MY_SECRET&#34;
  ]

  env = {
    RACK_ENV = &#34;production&#34;
  }
}
</code></pre><p>At this moment, you should also update your workflow:</p><pre tabindex=0><code class=language-github data-lang=github>...
resolves = [&#34;heroku.deploy&#34;]
...
</code></pre><p>because that&rsquo;s the action you need to resolve to.</p><p>For a cherry on the top, I would add Slack notification and for that, we will need custom action, turns out it&rsquo;s easy to do this. As a starting point, replicate the following structure in your project folder:</p><pre tabindex=0><code class=language-term data-lang=term>.github/
  slack/
    Dockerfile
    entrypoint.sh
</code></pre><p>For <code>entrypoint.sh</code> I defined a simple message posting to Slack:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#888;font-weight:700>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#888;font-weight:700></span><span style=font-weight:700;font-style:italic>set</span> -e
</span></span><span style=display:flex><span>curl -X POST -H <span style=color:#666;font-style:italic>&#39;Content-type: application/json&#39;</span> <span style=color:#666;font-style:italic>\
</span></span></span><span style=display:flex><span><span style=color:#666;font-style:italic></span> --data <span style=color:#666;font-style:italic>&#34;{\&#34;text\&#34;: \&#34;</span><span style=color:#666;font-weight:700;font-style:italic>$*</span><span style=color:#666;font-style:italic>\&#34;,\&#34;attachments\&#34;:[{\&#34;footer\&#34;: \&#34;</span><span style=color:#666;font-weight:700;font-style:italic>$GITHUB_ACTOR</span><span style=color:#666;font-style:italic> / </span><span style=color:#666;font-weight:700;font-style:italic>$GITHUB_REPOSITORY</span><span style=color:#666;font-style:italic> / </span><span style=color:#666;font-weight:700;font-style:italic>$GITHUB_SHA</span><span style=color:#666;font-style:italic>\&#34;}]}&#34;</span> <span style=color:#666;font-style:italic>\
</span></span></span><span style=display:flex><span><span style=color:#666;font-style:italic></span><span style=color:#666;font-weight:700;font-style:italic>$SLACK_WEBHOOK_URL</span>
</span></span></code></pre></div><p>The important part: <code>$*</code> - command arguments will be pasted here. For the rest, please refer to Slack documentation.</p><p>Minimal dockerfile:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=font-weight:700;text-decoration:underline>FROM</span> <span style=color:#666;font-style:italic>debian:9.5-slim</span><span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>RUN</span> apt-get update -qq &amp;&amp; apt-get install -y curl<span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ARG</span> SLACK_WEBHOOK_URL<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ARG</span> GITHUB_ACTOR<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ARG</span> GITHUB_REPOSITORY<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ARG</span> GITHUB_SHA<span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>LABEL</span> <span style=color:#666;font-style:italic>&#34;com.github.actions.name&#34;</span>=<span style=color:#666;font-style:italic>&#34;Slack notifier&#34;</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>LABEL</span> <span style=color:#666;font-style:italic>&#34;com.github.actions.description&#34;</span>=<span style=color:#666;font-style:italic>&#34;Sends message to slack channel&#34;</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>LABEL</span> <span style=color:#666;font-style:italic>&#34;com.github.actions.icon&#34;</span>=<span style=color:#666;font-style:italic>&#34;bell&#34;</span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>LABEL</span> <span style=color:#666;font-style:italic>&#34;com.github.actions.color&#34;</span>=<span style=color:#666;font-style:italic>&#34;yellow&#34;</span><span>
</span></span></span><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ADD</span> entrypoint.sh /entrypoint.sh<span>
</span></span></span><span style=display:flex><span><span></span><span style=font-weight:700;text-decoration:underline>ENTRYPOINT</span> [<span style=color:#666;font-style:italic>&#34;/entrypoint.sh&#34;</span>]<span>
</span></span></span></code></pre></div><p>GitHub labels allow to customize the visual appearance of our action (you can see it later in GitHub workflow view). For a full customization refer to the documentation: <a href=https://developer.github.com/actions/creating-github-actions/creating-a-new-action/#hello-world-action-example>creating-a-new-action</a> / <a href=https://developer.github.com/actions/creating-github-actions/creating-a-docker-container/#label>color list</a> / <a href=https://developer.github.com/actions/creating-github-actions/creating-a-docker-container/#supported-feather-icons>icon list</a>.</p><p>At the end, make sure your code is executable:</p><pre tabindex=0><code class=language-term data-lang=term>chmod +x entrypoint.sh
</code></pre><p>A final touch on workflow:</p><pre tabindex=0><code class=language-github data-lang=github>workflow &#34;Test and deploy to heroku&#34; {
  on = &#34;push&#34;
  resolves = [&#34;slack.notifier&#34;]
}

...

action &#34;slack.notifier&#34; {
  uses = &#34;./.github/slack&#34;
  needs = [&#34;heroku.deploy&#34;]
  args = &#34;Deployed!&#34;
  secrets = [&#34;SLACK_WEBHOOK_URL&#34;]
  # GITHUB_* envs are automatically here
}
</code></pre><p>and here is the result:</p><figure class=image><img src=/posts/2019/github-actions-beta-full-workflow.png><figcaption>Full workflow visualised</figcaption></figure><p>To sum it all up, I am very happy with the upcoming GitHub changes. My dummy project proved me that GitHub Actions are more than capable of replacing parts of our current pipeline and once a stable release is ready, we will plan to integrate it with our commercial project.</p><p>Link to repo: <a href=https://github.com/qbart/test-github-actions>https://github.com/qbart/test-github-actions</a>.</p><p>PS. If you find any errors in my article/code please let me know :)</p><p>And a couple of screenshots I took during the development:</p><figure class=image><img src=/posts/2019/github-actions-beta-managing-secrets.png><figcaption>Managing secrets</figcaption></figure><figure class=image><img src=/posts/2019/github-actions-beta-workflow-preview.png><figcaption>Workflow preview</figcaption></figure><figure class=image><img src=/posts/2019/github-actions-beta-editing-workflow-init.png><figcaption>Editing workflow (my initial attempts)</figcaption></figure><figure class=image><img src=/posts/2019/github-actions-beta-failed-workflow.png><figcaption>Failed workflow</figcaption></figure><figure class=image><img src=/posts/2019/github-actions-beta-failed-action-logs.png><figcaption>Failed action logs</figcaption></figure><figure class=image><img src=/posts/2019/github-actions-beta-invalid-workflow-config.png><figcaption>Invalid workflow config</figcaption></figure><figure class=image><img src=/posts/2019/github-actions-beta-workflow-in-progress.png><figcaption>Workflow in progress</figcaption></figure></div><aside class=article-aside><div class=aside-card><h4>Tags</h4><div class=tag-list><span class=tag>docker</span>
<span class=tag>github</span>
<span class=tag>github actions</span>
<span class=tag>aws</span>
<span class=tag>pipeline</span>
<span class=tag>ci</span></div></div></aside></div><div class=article-footer><a class=back-to-top href=#top><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5l-6 6m6-6 6 6M12 5v14" stroke-linecap="round" stroke-linejoin="round"/></svg>
Back to top</a></div></article></section></main><footer><div class=container><p>"The more I learn, the more I realize how much I don't know."</p></div></footer></body></html>